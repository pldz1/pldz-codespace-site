---
author: admin@pldz1.com
category: code-space
date: '2025-01-08'
serialNo: 2
status: publish
summary: æµè§ˆå™¨çš„ç½‘ç»œé…ç½®æ¥å£å®é™…ä¸Šæ˜¯å­˜åœ¨çš„, çœ‹ç€åŠŸèƒ½å®ç°ä¸éš¾, ç®€å•çš„åšäº†ä¸€ä¸ªæ‰‹åŠ¨é…ç½®ç½‘ç»œçš„æ’ä»¶.
tags:
- VUE3
thumbnail: /api/v1/website/image/code-space/bg_browser_proxy_plugin_thumbnail.png
title: æµè§ˆå™¨ç½‘ç»œæ’ä»¶
---

# ğŸŒ æµè§ˆå™¨ç½‘ç»œä»£ç†æ’ä»¶

## 0ï¸âƒ£ å‰è¨€

`Firefox` æµè§ˆå™¨ç½‘ç»œè®¾ç½®åŠŸèƒ½æˆ‘è§‰å¾—è¿˜æ˜¯è›®å®ç”¨çš„ï¼Œä½†æ˜¯ï¼Œ `Chrome` å’Œ `Edge` æµè§ˆå™¨å´æ²¡æœ‰ç±»ä¼¼çš„ç®€ä¾¿æ’ä»¶æˆ–å†…å»ºé€‰é¡¹ã€‚æˆ‘å‘ç°æµè§ˆå™¨çš„ç½‘ç»œé…ç½®æ¥å£å®é™…ä¸Šæ˜¯å­˜åœ¨çš„, çœ‹ç€åŠŸèƒ½å®ç°ä¸éš¾, ç®€å•çš„åšäº†ä¸€ä¸ªæ‰‹åŠ¨é…ç½®ç½‘ç»œçš„æ’ä»¶ ğŸ”§ğŸŒ.

---

## ğŸ˜ å¿«é€Ÿä½“éªŒ

ğŸ‘‰ **é¡¹ç›®æºç : [Browser_Proxy_Plugin](https://github.com/pldz1/Browser_Proxy_Plugin)**

> **ğŸ‰ æ¬¢è¿ä¸€èµ·äº¤æµï¼ğŸ’¬ (â­ï¸ start å’Œ ğŸ´ forkï¼Œæ„Ÿè°¢å¤§å®¶çš„æ”¯æŒï¼ğŸ™)**

![ä»£ç†è®¾ç½®é¡µé¢](/api/v1/website/image/code-space/bp_preview.png)

---

## ğŸ” æµè§ˆå™¨å…¼å®¹æ€§

ç›®å‰å·²åœ¨ä»¥ä¸‹æµè§ˆå™¨ä¸­æµ‹è¯•ï¼ŒåŠŸèƒ½å®Œå…¨æ­£å¸¸ï¼š

- ğŸŸ¢ **Chrome 131**
- ğŸŸ¢ **Edge 131**

å…¶ä»–ç°ä»£æµè§ˆå™¨ï¼ˆå¦‚ Firefox ç­‰ï¼‰ç†è®ºä¸Šä¹Ÿæ”¯æŒï¼Œä½†æ²¡æœ‰å»æµ‹è¯•ã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. **æ‰“å¼€ Chrome è®¾ç½®** âš™ï¸

   - ç‚¹å‡» Chrome çª—å£å³ä¸Šè§’çš„ `â‹®`ï¼ˆä¸‰ä¸ªç‚¹ï¼‰ã€‚
   - ä¾æ¬¡é€‰æ‹© **æ›´å¤šå·¥å…·** > **æ‰©å±•ç¨‹åº**ã€‚

2. **å¯ç”¨å¼€å‘è€…æ¨¡å¼** ğŸ§‘â€ğŸ’»

   - åœ¨æ‰©å±•ç¨‹åºé¡µé¢å³ä¸Šè§’ï¼Œæ‰¾åˆ° **å¼€å‘è€…æ¨¡å¼** å¼€å…³ï¼Œç‚¹å‡»å°†å…¶æ‰“å¼€ã€‚

3. **åŠ è½½è§£å‹åçš„æ–‡ä»¶å¤¹** ğŸ“

   - ç‚¹å‡»é¡µé¢å·¦ä¸Šè§’çš„ **åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº** æŒ‰é’®ã€‚
   - åœ¨å¼¹å‡ºçš„æ–‡ä»¶é€‰æ‹©çª—å£ä¸­ï¼Œé€‰æ‹©åˆšåˆšè§£å‹çš„æ’ä»¶æ–‡ä»¶å¤¹ã€‚

4. **ç¡®è®¤åŠ è½½æˆåŠŸ** âœ…
   - å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ’ä»¶ä¼šç«‹å³å‡ºç°åœ¨æ‰©å±•ç¨‹åºåˆ—è¡¨ä¸­ã€‚
   - ä½ å¯ä»¥åœ¨ Chrome å³ä¸Šè§’çš„æ‰©å±•å›¾æ ‡ä¸­çœ‹åˆ°å®ƒã€‚

---

## ğŸ”¨ ç®€å•çš„å®ç°é€»è¾‘

1. ç”¨ `HTML` è¯­è¨€å†™ `popup.html` ä¹Ÿå°±æ˜¯è¿™ä¸ªå¼¹å‡ºçš„ç•Œé¢çš„æ ·å¼

> æˆ‘å°è¯•å¼•å…¥ `VUE3` å’Œ `ElementPlus` æ¡†æ¶ å‘ç°ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ å¹¶ä¸”å®¹æ˜“å‡ºé”™, åé¢è°ƒæŸ¥å‘ç°ç”¨ `Bootstrap` æ˜¯ä¸é”™çš„ æœ‰æœºä¼šå¯ä»¥è¯•è¯•.

2. åœ¨ `module/popup.js` é‡Œé¢è·å–å…ƒç´ çš„ `id` ç„¶ååšäº‹ä»¶çš„ç›‘å¬å’Œä¸šåŠ¡çš„å®ç°, å…·ä½“ä»£ç å¦‚ä¸‹

```js
document.addEventListener("DOMContentLoaded", function () {
  // é»˜è®¤çš„bypassåˆ—è¡¨
  const defaultBypassList = ["127.0.0.1/8", "192.168.1.0/24", "::1", "localhost", ".net.nz"];

  // è¿™ä¸ªæ’ä»¶é»˜è®¤çš„æµè§ˆå™¨å­˜å‚¨çš„æ•°æ®æ ¼å¼
  let initialSettings = {
    bypassList: [],
    httpPort: "8080",
    httpProxy: "example.com",
    httpsPort: "",
    httpsProxy: "",
    proxyEnabled: false,
    socksHost: "",
    socksPort: "",
    useForHttps: false,
  };

  /** ================== Step 1 ================== */
  // å¾—åˆ°æ’ä»¶çš„å…¨éƒ¨ HTML Element
  const noProxyToggle = document.getElementById("no-proxy-checkbox");
  const manualProxyToggle = document.getElementById("manual-proxy-checkbox");

  const proxyConfiguration = document.getElementById("proxy-configuration");
  const proxyPanel = document.getElementById("proxy-panel");

  const httpProxyInput = document.getElementById("http-proxy");
  const httpPortInput = document.getElementById("http-port");
  const httpsProxyInput = document.getElementById("https-proxy");
  const httpsPortInput = document.getElementById("https-port");
  const socksHostInput = document.getElementById("socks-host");
  const socksPortInput = document.getElementById("socks-port");
  const bypassListInput = document.getElementById("bypass-list");
  const useForHttpsCheckbox = document.getElementById("use-for-https");
  const applyButton = document.getElementById("apply-button");
  const cancelButton = document.getElementById("cancel-button");

  /** ================== Step 2 ================== */
  // ç»™æ’ä»¶çš„HTML Elementæ³¨å…¥ç›‘å¬äº‹ä»¶ è§‚å¯Ÿå˜åŒ–
  // 2.1 ä¸ä½¿ç”¨ä»£ç†å’Œä½¿ç”¨æ‰‹åŠ¨ä»£ç†çš„äº’æ–¥è¡Œä¸º
  noProxyToggle.addEventListener("change", () => {
    if (noProxyToggle.checked) manualProxyToggle.checked = false;
    else manualProxyToggle.checked = true;
    // ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ä½¿ç”¨æ‰‹åŠ¨ä»£ç†çš„è¡Œä¸ºä¿ƒä½¿å®ƒå»ä¿®æ”¹æ ·å¼
    manualProxyToggle.dispatchEvent(new Event("change"));
  });

  manualProxyToggle.addEventListener("change", () => {
    if (manualProxyToggle.checked) {
      proxyConfiguration.classList.remove("disabled");
      proxyPanel.classList.remove("not-allowed");
      noProxyToggle.checked = false;
    } else {
      proxyConfiguration.classList.add("disabled");
      proxyPanel.classList.add("not-allowed");
      noProxyToggle.checked = true;
    }
  });

  // 2.2 HTTP å’Œ HTTPS å¦‚æœæ˜¯å…±äº«çŠ¶æ€çš„è¯éœ€è¦åŒæ­¥æ›´æ–°æ•°æ®
  httpProxyInput.addEventListener("input", () => {
    if (useForHttpsCheckbox.checked) httpsProxyInput.value = httpProxyInput.value;
  });

  httpPortInput.addEventListener("input", () => {
    if (useForHttpsCheckbox.checked) httpsPortInput.value = httpPortInput.value;
  });

  useForHttpsCheckbox.addEventListener("change", () => {
    if (useForHttpsCheckbox.checked) {
      httpsProxyInput.classList.add("disabled", "not-allowed");
      httpsPortInput.classList.add("disabled", "not-allowed");
      httpsProxyInput.value = httpProxyInput.value;
      httpsPortInput.value = httpPortInput.value;
    } else {
      httpsProxyInput.classList.remove("disabled", "not-allowed");
      httpsPortInput.classList.remove("disabled", "not-allowed");
    }
  });

  // 2.3 ä» HTML Element ä¸Šæ‹¿å‡ºçŠ¶æ€å†™å…¥å­˜å‚¨ å¹¶ä¸”éœ€è¦ç«‹å³ç”Ÿæ•ˆè®¾ç½®
  applyButton.addEventListener("click", () => {
    // è·å–ç”¨æˆ·è¾“å…¥å¹¶å°†å…¶åˆ†å‰²ä¸ºæ•°ç»„ï¼ŒåŒæ—¶ç§»é™¤å¤šä½™çš„ç©ºæ ¼
    const bypassList = bypassListInput.value
      .split(";")
      .map((url) => url.trim())
      .filter(Boolean);

    // å°†é»˜è®¤çš„bypassListåŠ å…¥ç”¨æˆ·è¾“å…¥çš„bypassList
    const finalBypassList = [...new Set([...defaultBypassList, ...bypassList])];

    const proxyConfig = {
      mode: "fixed_servers",
      rules: {
        singleProxy: {
          scheme: "http",
          host: httpProxyInput.value || "example.com",
          port: parseInt(httpPortInput.value) || 8080,
        },
        // ä½¿ç”¨åˆå¹¶åçš„ bypassList
        bypassList: finalBypassList,
      },
    };

    // ä¿å­˜è®¾ç½®åˆ° Chrome å­˜å‚¨ä¸­
    chrome.storage.sync.set(
      {
        proxyEnabled: manualProxyToggle.checked,
        httpProxy: httpProxyInput.value,
        httpPort: httpPortInput.value,
        httpsProxy: useForHttpsCheckbox.checked ? httpProxyInput.value : httpsProxyInput.value,
        httpsPort: useForHttpsCheckbox.checked ? httpPortInput.value : httpsPortInput.value,
        socksHost: socksHostInput.value,
        socksPort: socksPortInput.value,
        // ä¿å­˜åˆå¹¶åçš„ bypassList
        bypassList: finalBypassList,
        useForHttps: useForHttpsCheckbox.checked,
        // ä¿å­˜ä»£ç†é…ç½®
        proxySettings: proxyConfig,
      },
      // ç«‹å³åº”ç”¨è®¾ç½®
      function () {
        if (manualProxyToggle.checked) {
          chrome.proxy.settings.set(
            {
              value: proxyConfig,
              scope: "regular",
            },
            function () {}
          );
        } else {
          chrome.proxy.settings.clear({ scope: "regular" }, function () {});
        }
      }
    );
    window.close();
  });

  // 2.4 å–æ¶ˆè®¾ç½®éœ€è¦å›é€€å›å­˜å‚¨ä¸­è®°å½•çš„çŠ¶æ€
  cancelButton.addEventListener("click", () => {
    // æ¢å¤åˆ°åˆå§‹è®¾ç½®
    if (initialSettings.proxyEnabled) manualProxyToggle.checked = initialSettings.proxyEnabled;
    if (initialSettings.httpProxy) httpProxyInput.value = initialSettings.httpProxy;
    if (initialSettings.httpPort) httpPortInput.value = initialSettings.httpPort;
    if (initialSettings.httpsProxy) httpsProxyInput.value = initialSettings.httpsProxy;
    if (initialSettings.httpsPort) httpsPortInput.value = initialSettings.httpsPort;
    if (initialSettings.socksHost) socksHostInput.value = initialSettings.socksHost;
    if (initialSettings.socksPort) socksPortInput.value = initialSettings.socksPort;

    const userBypassList = initialSettings.bypassList ? initialSettings.bypassList : [];
    const combinedBypassList = [...new Set([...defaultBypassList, ...userBypassList])];
    bypassListInput.value = combinedBypassList.join(", ");

    if (initialSettings.useForHttps !== undefined) useForHttpsCheckbox.checked = initialSettings.useForHttps;

    // å…³é—­ popup
    window.close();
  });

  /** ================== Step 3 ================== */
  // å…¥å£å‡½æ•° æ’ä»¶åˆå§‹åŒ–çš„æ“ä½œ
  chrome.storage.sync.get(
    ["proxyEnabled", "httpProxy", "httpPort", "httpsProxy", "httpsPort", "socksHost", "socksPort", "bypassList", "useForHttps"],
    function (result) {
      initialSettings = result;
      // äº’æ–¥çš„ä¸¤ä¸ªå¼€å…³é€‰é¡¹
      if (result.proxyEnabled) manualProxyToggle.checked = true;
      manualProxyToggle.dispatchEvent(new Event("change"));

      if (result.httpProxy) httpProxyInput.value = result.httpProxy;
      if (result.httpPort) httpPortInput.value = result.httpPort;
      if (result.httpsProxy) httpsProxyInput.value = result.httpsProxy;
      if (result.httpsPort) httpsPortInput.value = result.httpsPort;
      if (result.socksHost) socksHostInput.value = result.socksHost;
      if (result.socksPort) socksPortInput.value = result.socksPort;

      // åˆå¹¶ä¸æ˜¾ç¤ºé»˜è®¤å»æ‰çš„bypassList
      const userBypassList = result.bypassList ? result.bypassList : [];
      const combinedBypassList = userBypassList.filter((item) => !defaultBypassList.includes(item));

      bypassListInput.value = combinedBypassList.join("; ");

      if (result.useForHttps) useForHttpsCheckbox.checked = result.useForHttps;
      useForHttpsCheckbox.dispatchEvent(new Event("change"));
    }
  );
});
```

å¤§æ¦‚çš„æ¡†å›¾å¯ä»¥è¿™ä¹ˆè¡¨ç¤º, ä¸€çœ‹å°±æ˜ç™½

![å‡½æ•°è®¾è®¡æµç¨‹å›¾](/api/v1/website/image/code-space/bp_function_designer_mermaid.png)

---